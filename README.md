This is the implementation of our paper [Visual Privacy Protection via Mapping Distortion](https://arxiv.org/pdf/1911.01769.pdf), accepted by the IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP) 2021. This project is developed based on Python 3.6, created by [Peidong Liu](https://perdonliu.github.io/) and [Yiming Li](http://liyiming.tech/).

## Citation
If our work is useful for your research, please cite our paper as follows:
```
@inproceedings{li2021visual,
  title={Visual Privacy Protection via Mapping Distortion},
  author={Li, Yiming and Liu, Peidong and Jiang, Yong and Xia, Shu-Tao},
  booktitle={ICASSP},
  year={2021}
}
```

## Install Pre-requisites

```bash
pip install -r requirements.txt
```

## Generating the Modified CIFAR-10 Dataset

- Download [pretrained model](https://drive.google.com/file/d/1BVPlp5ory1smQOD1GKB5Gop2cqGHT7m2/view?usp=sharing) from Google Drive and put it in the folder "/path/to/project/runs/train_original_cifar10/checkpoints/".

- Download original [cifar10 training images](https://drive.google.com/file/d/1HXPsYtSQ-7cXYtk96rOMw4P9znKpsvzP/view?usp=sharing) and original [cifar10 testset](https://drive.google.com/file/d/1Ej1kKPv0KWte32l-qUIUD51naSD782Pv/view?usp=sharing) from Google Drive, put them in the folder "/path/to/project/data" and unzip them.
```bash
unzip cifar10_ori_images.zip
unzip testdir.zip
```



- Run the script below to start the generation process for MDP.

```bash
bash generate_modified_cifar10.sh /path/to/project/experiments/generate_modified_cifar10_resnet.yaml
```

- Check modified cifar10 locates at '/path/to/project/data/generate_modified_cifar10_resnet/'.

- Run the script below to start the generation process for AugMDP (T=2).

```bash
bash generate_modified_cifar10.sh /path/to/project/experiments/generate_modified_cifar10_resnet_multi2.yaml
```

- Check modified cifar10 (T=2) locates at '/path/to/project/data/generate_modified_cifar10_resnet_multi2/'.


## Training on the Modified CIFAR-10 Dataset

- Run the script below to start the training process on the dataset generated by MDP.

```bash
bash train_modified_cifar10.sh /path/to/project/experiments/train_modified_cifar10.yaml
```

- Run the script below to start the training process on the dataset generated by AugMDP (T=2).

```bash
bash train_modified_cifar10.sh /path/to/project/experiments/train_modified_cifar10_multi2.yaml
```


## Acknowledgement

Thanks to MadryLab (https://github.com/MadryLab/constructed-datasets) for their inspiration. 
